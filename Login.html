<!DOCTYPE html>
<html>
  <head>
    <title>SIGN IN</title>
  </head>
  <center style="zoom: 200%;">
    <body style="background-color:gainsboro">
      <br />Username:<br />
      <input type="text" id="username" value="" /><br />
      <br />Password:<br />
      <input type="password" id="password" value="" /><br />

      <p></p>
      <button type="submit" value="Submit" onclick="getShit()">submit</button>
    </body>
  </center>
  <script>
    async function getShit() {
      var userElement = document.getElementById('username'); // current html element
      var passElement = document.getElementById('password');

      var User = userElement.value; // gets val in string form
      var Pass = passElement.value;

      var jsonData = { user: User, pass: Pass };
      // var jsonData = JSON.stringify(jsonData); // transformed into json format
      //curl the data below

      let res = await fetch(
        'https://web.njit.edu/~ah472/CS490/beta/back/login.php',
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            user: User,
            pass: Pass,
          }),
        }
      );

      const json = await res.json();

      console.log(json);
      checkShit(json);
      //window.alert(json.type);
    }
    //Put handling for logins
    // If student puts in student login, goes to exam page
    // If teacher logs in, Goes to instructor page
    // IF neither, tell them to fuck off
    function checkShit(data) {
      //console.log(data[0].code);
      //console.log(data[0].type);
      if (data == null) {
        window.alert('You are not welcome here you scrub!');
      } else if (data[0].code == 0 && data[0].type == 'student') {
        location.replace('https://web.njit.edu/~jps78/studentLand.html');
      } else if (data[0].code == 0 && data[0].type == 'teacher') {
        location.replace('https://web.njit.edu/~jps78/instructorLand.html');
      }
    }
  </script>
</html>
